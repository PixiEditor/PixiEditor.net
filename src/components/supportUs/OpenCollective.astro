---
import { Image } from "astro:assets";

import SilverTier from "@assets/icons/donationTiers/silver.svg";
import GoldTier from "@assets/icons/donationTiers/gold.svg";
import DiamondTier from "@assets/icons/donationTiers/diamond.svg";
import PlatinumTier from "@assets/icons/donationTiers/diamond.svg";

import { openCollective as links } from "../../assets/links";
---

<h1 class="text-2xl font-bold text-center">Support us with</h1>

<div class="flex mt-12 items-center justify-center">
    <div class="flex gap-6">
        <a class="flex flex-col items-center px-6 py-3 rounded bg-neutral-900 gap-1" href={links.silver} target="_blank">
            <h2 class="uppercase font-bold">Silver</h2>
            <Image src={SilverTier} alt="" />
            <p class="font-bold">$5 <span class="text-xs font-normal">/ month</span></p>
        </a>
        <a class="flex flex-col items-center px-6 py-3 rounded bg-neutral-900 gap-1" href={links.gold} target="_blank">
            <h2 class="uppercase font-bold">Gold</h2>
            <Image src={GoldTier} alt="" />
            <p class="font-bold">$10 <span class="text-xs font-normal">/ month</span></p>
        </a>
        <a class="flex flex-col items-center px-6 py-3 rounded bg-neutral-900 gap-1" href={links.diamond} target="_blank">
            <h2 class="uppercase font-bold">Diamond</h2>
            <Image src={DiamondTier} alt="" />
            <p class="font-bold">$25 <span class="text-xs font-normal">/ month</span></p>
        </a>
        <a class="flex flex-col items-center px-6 py-3 rounded bg-neutral-900 gap-1" href={links.platinum} target="_blank">
            <h2 class="uppercase font-bold">Platinum</h2>
            <Image src={PlatinumTier} alt="" />
            <p class="font-bold">$50 <span class="text-xs font-normal">/ month</span></p>
        </a>
    </div>

    <p class="uppercase font-bold px-12">or</p>

    <div class="">
        <div class="bg-neutral-700 focus-within:outline rounded p-2">
            <input class="bg-transparent placeholder:text-white placeholder:opacity-50 outline-none w-32" type="number" placeholder="Enter amount" id="donate-amount" />
            <label class="cursor-text" for="donate-amount">$</label>
        </div>
        <button class="mt-3 p-3 px-6 bg-neutral-900 rounded w-full" data-donate-button>Donate</button>

        <script>
            const amountInput = document.getElementById("donate-amount");
            amountInput.addEventListener("change", ceilValue);

            const donateButtons = document.querySelectorAll('[data-donate-button]');

            donateButtons.forEach((button) => {
                button.addEventListener('click', donateCustomAmount);
            });

            function ceilValue() {
                const originalValue = amountInput.value as number;
                const newValue = Math.max(Math.floor(originalValue), 1);

                if (originalValue === newValue) {
                    return;
                }

                amountInput.value = newValue;
            }

            function donateCustomAmount() {
                ceilValue();

                const amount = amountInput.value as number;
                // TODO: Maybe move this in links.ts if possible
                const url = `https://opencollective.com/pixieditor/donate?interval=oneTime&amount=${amount}`;

                window.open(url, "_blank");
            }
        </script>
    </div>
</div>