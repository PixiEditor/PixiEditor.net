---
import { getAuthors, getBlogPath } from "@content/contentHelper";
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import { Image } from "astro:assets";
import { Picture } from "astro:assets";
import Lucide from "@components/Lucide.astro";

import BlogCover from "../content/blog/assets/defaultBlogCover.png";

const posts = await getCollection("blog");
---

<Layout title="Blog" description="PixiEditor Blog" cover="img/blog-cover.png">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold my-12">
            All Articles
            <a href="/blog.xml" target="_blank" class="text-neutral-500 cursor-pointer hover:text-neutral-100 ps-1" title="RSS Feed">
                <Lucide class="align-text-bottom" data="rss" />
            </a>
        </h1>
        <div class="grid gap-y-12 gap-x-12 mb-12 md:grid-cols-1 lg:grid-cols-3">
            {
                posts
                    .sort(function (o1, o2) {
                        return o1.data.date.getTime() - o2.data.date.getTime();
                    })
                    .reverse()
                    .map((x) => {
                        return (
                            <a class="flex flex-col gap-2" href={getBlogPath(x)}>
                                    <Picture
                                        class="object-contain rounded-lg border-neutral-700 border-2"
                                        src={x.data.cover ?? BlogCover}
                                        widths={[300, 740, 1080]}
                                        alt=""/>

                                    <p class="text-neutral-400">
                                        {x.data.date.toLocaleDateString(
                                            "en-us",
                                            { dateStyle: "long" },
                                        )}
                                    </p>
                                <p class="text-xl font-bold">{x.data.title}</p>

                                <div class="flex flex-row gap-2">
                                    <Image class="rounded-full h-6 w-6" src={getAuthors(x)![0].data.picture} alt=""/>
                                    <p>{getAuthors(x)![0].data.name}</p>
                                </div>
                            </a>
                        );
                    })
            }
        </div>
    </div>
</Layout>
